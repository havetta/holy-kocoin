
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>MXP Generator</title>
</head>

<body>
  <!-- Navbar -->
  <header class="navbar z-50 mb-5 p-4 fixed top-0 left-0 right-0 bg-white shadow-lg border-none no-underline">
    <div class="navbar-start" >
      <div class="dropdown">
        <label tabindex="0" class="btn btn-ghost btn-circle">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
          </svg>
        </label>
        <ul data-theme="bumblebee" tabindex="0" class="z-60 menu menu-compact dropdown-content mt-5 p-2 shadow-lg bg-base-100 rounded-box w-52">
          <!-- dot burger buttons with another theme! -->
          <nav class="p-4">
            <a href="/lit" class="m-2 btn btn-primary">Homepage</a>
            <a href="/vue" class="m-2 btn btn-secondary">Vue</a>
            <a class='m-2 btn btn-accent' href='/lit/preact'>Preact</a>
            <a class='m-2 btn bg-base-300' href='/lit/form'>JsonForm</a>
            <a class='m-2 btn bg-blue-400' href='/lit/solidjs'>SolidJS</a>
            <a class='m-2 btn bg-purple-300' href='/lit/htmx'>Htmx</a>
          </nav>
        </ul>
      </div>
    </div>
    <div class="navbar-center">
      <a class="pagetitle btn btn-ghost normal-case text-xl" href="https://htmx.org/docs/#ajax"></a>
      <script type="text/javascript">
        document.querySelectorAll(".pagetitle")?.forEach((e) => e.innerText = document.title);
      </script>
    </div>
    <div class="navbar-end">
      <label for="my-modal-3" class="btn btn-ghost btn-circle">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
      </label>
      <!-- Search Modal -->
      <input type="checkbox" id="my-modal-3" class="modal-toggle">
      <div class="modal">
        <div class="modal-box relative">
          <label for="my-modal-3" class="btn btn-sm btn-circle border-none bg-base-100 text-black font-bold absolute right-2 top-2">âœ•</label>
          <div class="form-control pr-6">
            <input type="text" placeholder="Search" class="input input-bordered bg-base-100 " />
          </div>
        </div>
      </div>
    </div>
  </header>
  <!-- End-Navbar -->





  <section hx-ext='client-side-templates' class="h-full bg-gray-200 text-gray-800 mt-10 p-4 lg:p-8">
    <button hx-get="https://dummyjson.com/todos"
            hx-swap="innerHTML"
            hx-target="#content"
            mustache-template="sometemplate"
            class="btn btn-primary">
      Reload
    </button>

    <p id="content" class="m-8"></p>

    <template id="sometemplate">
      <p> {% raw %}{{total}}{% endraw %} and {% raw %}{{limit}}{% endraw %}</p>
    </template>

    <aside class="flex items-center mb-1">
      <h1 class="flex-grow text-xl">MXP Components</h1>
      <!-- hx-trigger="load, click" makes sure that api gets called on pageload AND on click  !-->
      <button class="py-2 px-4 rounded bg-blue-500 text-white flex-grow-0"
              type="button"
              hx-trigger="load, click"
              hx-get="https://node-hnapi.herokuapp.com/news?page=0" 
              nunjucks-template="gistlist"
              hx-target="#list"
              hx-swap="innerHTML">
        Reload
      </button>   
    </aside>

    <p id="list" class="m-8"></p>

    <script id="gistlist" type="nunjucks">
      {% for gist in gists %}
        <li class="relative -mb-px block border p-1 border-grey">
          <a href="{{gist.url}}" class="font-bold">{{gist.title}}</a> ({{gist.time_ago}})<br>
        </li>
      {% endfor %}
    </script>

    <script type="module">
    htmx.logger = function(elt, event, data) {
      if(console) {
          console.debug(event, elt, data);
      }
    }

    document.body.addEventListener('configRequest.htmx', function(evt) {
        // try to remove x-hx-* headers because gist api complains about CORS
        Object.keys(evt.detail.headers).forEach(function(key) { 
          delete evt.detail.headers[key]; 
        });
    });

    htmx.defineExtension('client-side-templates', {
        transformResponse : function(text, xhr, elt) {
          var nunjucksTemplate = htmx.closest(elt, "[nunjucks-template]");
            if (nunjucksTemplate) {
                var data = {
                  gists: JSON.parse(text).map((item) => {
                    // parser : https://codepen.io/localhorst/pen/ZEbqVZd
                    //item.parsed = new leptonParser().parse(item.description);
                    return item; 
                  })
                };

                var templateName = nunjucksTemplate.getAttribute('nunjucks-template');
                var template = htmx.find('#' + templateName);
                console.warn(templateName,data);
                return nunjucks.renderString(template.innerHTML, data);
            }
            return text;
        }
    });
    </script>
  </section>




  <script src="https://cdnjs.cloudflare.com/ajax/libs/htmx/1.9.10/htmx.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/htmx.org/dist/ext/client-side-templates.js"></script>
  <script src="https://unpkg.com/mustache@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/nunjucks@3.2.4/browser/nunjucks.min.js"></script>  <!-- <script src="../js/htmx.min.js"></script> -->

  <link href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.css" rel="stylesheet" type="text/css" />


</body>
</html>